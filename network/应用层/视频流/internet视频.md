### 流式存储视频应用
- 预先录制[[#视频]]，放置在服务器中
- 用户**按需**请求观看视频

### 视频
- 一系列**图像**
- 以**恒定速率**（如：24或30图像/s）展现图像
- 每张图像由**像素**阵列组成
- 每个像素由**bit编码**表示**亮度**和**颜色**
- 能够被压缩
- 压缩后，用bit率权衡视频质量
- 压缩算法可以压缩成所希望的任何bit率
- bit率越高，图像质量越好

### 网络中的视频
- internet视频的bit率范围：
	1. 低质量视频：100kbps
	2. 流式高分辨率电影：3Mbps
	3. 4K流式展望：10Mbps
- 流式视频的性能度量：平均吞吐量（端到端）
- 为了视频能连续不断的播放，网络提供的平均吞吐量至少与压缩视频的bit率一样大
- 可以将一个视频压缩生成多个版本，每个版本有不同的质量等级，如：bit率分别为300kbps、1Mbps、3Mbps，根据用户当前带宽决定观看哪个版本

### HTTP流
- 视频是存储在HTTP服务器中的一个普通文件
- 每个文件有特定的URL
- 用户请求该视频
- **服务器**以底层网络协议和流量条件尽可能块的速率，在响应中发送该视频文件
- **客户**将字节收集到应用缓存中
- 客户一旦缓存中的字节数量超过预先设定的门限，就开始播放
- **视频播放程序**周期性的从**客户应用程序缓存**中抓取帧
- 即：一边缓存，一边播放
- 缺点：所有客户接收到相同编码的视频

### DASH
- 经HTTP的动态适应性流（Dynamic Adaptive Streaming over HTTP）
- 客户可以自由的在不同质量版本的视频之间切换
##### 简略过程
- 对每个视频进行不同比率的编码，生成不同版本，放在服务器
- 客户动态请求不同版本，且长度为几秒的视频段数据
- 客户可用带宽高时，选择高速率版本的块，反之亦然

##### 详细过程
- 每个版本的视频都有自己的URL
- 服务器有一个**告示文件（manifest file）**，为每个版本提供URL和bit率
- 客户首先请求该告示文件，得知各个版本信息
- 客户通过HTTP请求，对每块指定一个URL和字节范围，一次选择一块，进行下载
- 下载时，测量接收带宽并运行**速率决定算法**，选择下次请求的块
- 客户缓存的视频片段多，且测量的接收带宽高，则下载高速率的版本，反之亦然

### 如何分发
- 见[[CDN]]