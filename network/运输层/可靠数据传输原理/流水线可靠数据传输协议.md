### rdt3.0的性能问题
- [[构造可靠数据传输协议#rdt3.0|rdt3.0]]的性能是有问题的，因为它是个停等协议
- 假设
	1. 两个端系统之间的光速往返传播时延[[RTT]]约为30ms
	2. 两者通过一条发送速率R为1Gbps的信道相连。
	3. 分组长度为1000byte(8000bit)
- 则：
	1. 发送一个分组的时间：$t_{trans} = \frac L R = \frac {8000bit/pkt} {10^9bit/s} = 8 us/pkt$
- 发送接收过程：
	1. $t=0$时，发送方发送分组
	2. $t=8us$时，分组最后一个bit进入信道，
	3. $t=RTT/2 + L/R = 15.008ms$时，分组最后一个bit到达接收方
	4. 接收方接收到分组最后一个bit后立刻发送ACK，ACK很短
	5. $t=RTT + L/R = 30.008ms$，ACK到达发送方
	6. 发送方发送下一个分组
- 该过程中，发送方发送分组进入信道用时$t=8us$，但直到$t=RTT + L/R = 30.008ms$时才可以发送下一分组
-  发送方(或信道)的**利用率(utilization)**（$U_{sender}$）定义为：发送方实际忙于将发送比特送进信道的那部分时间与发送时间之比
-  上述过程: $U_{sender} = \frac {L/R} {RTT + L/R} = \frac 0.008 30.008 = 0.00027$
-  发送方在30. 008ms内只能发送1000字节，有效的吞吐量仅为267kbp，而链路传输速率1Gbps
-  网络协议限制底层网络硬件所提供的能力

### 流水线
- 可以解决rdt3.0的性能问题
- 不以停等方式运行，允许发送方发送多个分组而无须等待确认
- 发送方等待ACK分组的时间，可以发送多个分组
- 许多分组从发送方源源不断的发往信道，可以看成分组填充到流水线上，这种技术称为**流水线(pipelining)**

### 流水线带来的影响
- 必须增加序号范围：每个输送中的分组必须有一个唯一的序号，而且也许有多个在输送中的未确认报文
- 发送方和接收方两端可能要缓存多个分组：发送方最低要缓冲已发送但没有确认的分组。接收方或许要缓存已正确接收的分组
- 序号范围和对缓冲的要求取决于协议如何处理丢失、损坏、延时过大的分组
- 解决上述流水线的差错恢复有两种基本方法是:
	1. **[[回退N步（GBN）]] **
	2. **[[选择重传（SR）]]**