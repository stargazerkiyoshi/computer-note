### 简介
- 将一台主机的邮件推到另一台主机
- 是[[email]]中的主要**[[internet协议栈#应用层]]协议**
- 使用[[两种特定的internet运输服务#TCP服务|TCP可靠数据传输服务]]，从发送方[[email#邮件服务器]]发送邮件到接收方邮件服务器
- 所有报文体部分，只能采用7位ASCII码编码（历史原因），多媒体数据也是如此

### 运行地点
- 发送方邮件服务器的SMTP客户端（客户SMTP）
- 接收方邮件服务器的SMTP服务器端（服务器SMTP）
- 每台[[email#邮件服务器]]既运行SMTP客户端也运行SMTP服务器端

### 运行过程
##### 场景
- Alice给Bob发送一封简单的ASCII报文
##### 过程
1. Alice，使用[[email#用户代理|邮件代理]]程序，提供Bob的邮件地址（Bob@some.com）,撰写报文，然后指示发送
2. **Alice的[[email#用户代理|用户代理]]**，把报文发送到她的[[email#邮件服务器|邮件服务器]]中，报文被存放在那里的报文队列中
3. **Alice的[[email#邮件服务器|邮件服务器]]的SMTP客户端**，在队列中发现该报文，创建一个到**Bob的邮件服务器的SMTP服务器端**的TCP连接
4. 经过初始SMTP握手后，**Alice的[[email#邮件服务器|邮件服务器]]的SMTP客户端**通过该TCP连接发送报文
5. **Bob的邮件服务器的SMTP服务器端**接收该报文，服务器将该报文放入Bob邮箱中
6. Bob方便的时候，使用用户代理阅读该报文
![[发送email报文.png]]

### 过程总结
- 服务器双方直接通过TCP连接。SMTP一般不使用中间邮件服务器来发送邮件
- 接收方服务器没有开机，则报文保留在发送方的邮件服务器上，并等待尝试

### 报文从发送邮件服务器传送到接收服务器的过程
1. 客户SMTP（在发送邮件服务器中）在25号端口建立一个到服务器SMTP（在接收邮件服务器中）的TCP连接
2. 检查服务器有没有开机。如果没有开机，则稍后尝试连接
3. 建立连接成功后，执行SMTP应用层的握手动作（自我介绍）
	- 客户SMTP指示发送方邮件地址和接收方的邮件地址
4. 依赖TCP提供的服务，可靠的将邮件投递到接收服务器
5. 如有另外报文要发送到该服务器，则在该TCP连接重复这种处理
6. 指示TCP关闭连接